
<!DOCTYPE html>
<html lang="zh-Hant" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>生產資訊中心 - 訂單查詢</title>
    <link rel="icon" type="image/svg+xml" href="{{ url_for('static', filename='favicon.svg') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/pico.min.css') }}">
    <!-- 🆕 CSS 變數系統（新架構） -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/base/variables.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <!-- 🆕 系統狀態徽章（右上角） -->
    <div class="system-status-badge">
        <span class="status-indicator loading"></span>
        <span id="status-badge-text">檢查中...</span>
    </div>

    <main class="container">
        <header>
            <h1>生產資訊中心</h1>
            <p>一個整合工單料況、庫存與規格的查詢系統</p>
        </header>
        
        <nav>
            <ul>
                <li><a href="/procurement">採購儀表板</a></li>
                <li><a href="/order_query" class="active">訂單查詢</a></li>
                <li><a href="/admin_dashboard">後台管理</a></li>
            </ul>
        </nav>

        <hr>

        <section id="order-search">
            <h2>訂單詳情與規格查詢</h2>
            <div class="grid">
                <input type="text" id="order-id-input" placeholder="請輸入訂單號碼 (例如: 100001908)">
                <button id="search-order-btn">查詢訂單</button>
            </div>

            <!-- 按鈕群組 -->
            <div class="button-group">
                <button id="download-specs-btn" disabled>下載當前訂單規格表</button>
            </div>
            
            <!-- 訂單內容容器 -->
            <div id="order-details-container">
                <!-- 初始提示訊息 -->
                <p>請輸入訂單號碼進行查詢。</p>
            </div>
            
            <!-- 頁籤導覽 (初始隱藏) -->
            <nav id="order-tabs-nav" style="display: none;">
                <ul>
                    <li><a href="#" class="order-tab-link active" data-tab="tab-order-specs">訂單規格</a></li>
                    <li><a href="#" class="order-tab-link" data-tab="tab-order-materials">物料清單</a></li>
                </ul>
            </nav>
            
            <!-- 頁籤內容 -->
            <div id="order-tabs-content" style="display: none;">
                <div id="tab-order-specs" class="order-tab-content active">
                    <!-- 訂單規格將顯示在這裡 -->
                </div>
                <div id="tab-order-materials" class="order-tab-content">
                    <!-- 物料清單將顯示在這裡 -->
                </div>
            </div>
        </section>

    </main>

    <!-- 物料詳情彈出視窗 (Modal) -->
    <dialog id="details-modal">
        <article>
            <header>
                <a href="#close" aria-label="Close" class="close"></a>
                <h3 id="modal-title">物料詳情</h3>
            </header>
            
            <!-- 庫存總覽區塊 -->
            <div id="stock-summary-section">
                <h4>庫存總覽</h4>
                <p>未限制庫存: <span id="unrestricted-stock"></span></p>
                <p>品質檢驗中: <span id="inspection-stock"></span></p>
                <p>已訂未入: <span id="on-order-stock"></span></p>
            </div>

            <!-- 分頁導覽 -->
            <nav>
                <ul>
                    <li><a href="#" class="tab-link active" data-tab="tab-demand">需求訂單</a></li>
                    <li><a href="#" class="tab-link" data-tab="tab-substitute">可替代版本</a></li>
                </ul>
            </nav>

            <!-- 分頁內容 -->
            <div id="modal-content">
                <div id="tab-demand" class="tab-content active">
                    <!-- 需求訂單表格將會被動態插入這裡 -->
                </div>
                <div id="tab-substitute" class="tab-content">
                    <!-- 替代版本庫存表格將會被動態插入這裡 -->
                </div>
            </div>

            <footer>
                <button class="secondary" id="close-modal-btn">關閉</button>
            </footer>
        </article>
    </dialog>

    <!-- 🆕 服務層（新架構 - 必須在其他 JS 之前載入） -->
    <script src="{{ url_for('static', filename='js/services/api-service.js') }}"></script>
    <script src="{{ url_for('static', filename='js/services/notification-service.js') }}"></script>
    
    <!-- 原有的 JS 檔案 -->
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>
