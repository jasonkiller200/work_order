<!DOCTYPE html>
<html lang="zh-Hant" data-theme="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å“è™Ÿ-åœ–è™Ÿç¶­è­· - ç”Ÿç”¢è³‡è¨Šä¸­å¿ƒ</title>
    <link rel="icon" type="image/svg+xml" href="{{ url_for('static', filename='favicon.svg') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/pico.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
        .management-container {
            margin-top: 2rem;
        }

        .action-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            gap: 1rem;
        }

        .search-box {
            flex-grow: 1;
            margin-bottom: 0 !important;
        }

        .table-container {
            overflow-x: auto;
            background: var(--pico-card-background-color);
            border-radius: 8px;
            padding: 1rem;
            box-shadow: var(--pico-card-box-shadow);
        }

        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1rem;
            margin-top: 2rem;
        }

        .required-mark {
            color: var(--pico-form-element-invalid-active-border-color);
        }

        .status-badge {
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-size: 0.85rem;
        }

        .badge-success {
            background-color: #28a745;
            color: white;
        }

        .badge-warning {
            background-color: #ffc107;
            color: black;
        }

        .btn-group {
            display: flex;
            gap: 0.5rem;
        }

        .btn-sm {
            padding: 0.2rem 0.6rem;
            font-size: 0.9rem;
        }
    </style>
</head>

<body>
    <main class="container">
        <header>
            <h1>å“è™Ÿ-åœ–è™Ÿç¶­è­·ç³»çµ±</h1>
            <p>ç®¡ç†å“è™Ÿèˆ‡å°æ‡‰åœ–è™Ÿçš„é—œè¯è³‡æ–™</p>
        </header>

        <nav>
            <ul>
                <li><a href="/procurement">æ¡è³¼å„€è¡¨æ¿</a></li>
                <li><a href="/allocated-shortage">å·²æ’¥ç¼ºæ–™</a></li>
                <li><a href="/order_query">è¨‚å–®æŸ¥è©¢</a></li>
                <li><a href="/admin_dashboard">å¾Œå°ç®¡ç†</a></li>
                {% if is_admin %}
                <li><a href="/part-drawing-management" class="active">å“è™Ÿ-åœ–è™Ÿç¶­è­·</a></li>
                <li><a href="/component-requirements">æˆå“çµ„ä»¶éœ€æ±‚</a></li>
                {% endif %}
                <li><a href="/work-order-statistics">å·¥å–®è©³æƒ…çµ±è¨ˆ</a></li>
            </ul>
        </nav>

        <hr>

        <section class="management-container">
            <div class="action-bar">
                <div class="search-box">
                    <input type="search" id="search-input" placeholder="æœå°‹å“è™Ÿæˆ–åœ–è™Ÿ..." aria-label="Search">
                </div>
                <div class="btn-group">
                    <button id="add-single-btn" class="contrast">â• æ–°å¢ç­†</button>
                    <button id="batch-import-btn" class="secondary">ğŸ“¤ æ‰¹é‡åŒ¯å…¥</button>
                </div>
            </div>

            <div class="table-container">
                <table id="mapping-table">
                    <thead>
                        <tr>
                            <th>å“è™Ÿ</th>
                            <th>åœ–è™Ÿ</th>
                            <th>æœ€å¾Œæ›´æ–°</th>
                            <th>æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody id="mapping-tbody">
                        <tr>
                            <td colspan="4" style="text-align: center;">è¼‰å…¥ä¸­...</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="pagination">
                <button id="prev-page" class="outline btn-sm">ä¸Šä¸€é </button>
                <span id="page-info">ç¬¬ 1 / 1 é  (å…± 0 ç­†)</span>
                <button id="next-page" class="outline btn-sm">ä¸‹ä¸€é </button>
            </div>
        </section>
    </main>

    <!-- æ–°å¢/ç·¨è¼¯ Modal -->
    <dialog id="mapping-modal">
        <article>
            <header>
                <a href="#close" aria-label="Close" class="close" id="close-modal-x"></a>
                <h3 id="modal-title">æ–°å¢å°ç…§è³‡æ–™</h3>
            </header>
            <form id="mapping-form">
                <div class="grid">
                    <label for="part-number">
                        å“è™Ÿ <span class="required-mark">*</span>
                        <input type="text" id="part-number" name="part_number" placeholder="è«‹è¼¸å…¥å“è™Ÿ" required>
                    </label>
                    <label for="drawing-number">
                        åœ–è™Ÿ <span class="required-mark">*</span>
                        <input type="text" id="drawing-number" name="drawing_number" placeholder="è«‹è¼¸å…¥åœ–è™Ÿ" required>
                    </label>
                </div>
                <input type="hidden" id="edit-mode" value="false">
                <p id="error-message" style="color: red; display: none;"></p>
            </form>
            <footer>
                <button class="secondary" id="cancel-btn">å–æ¶ˆ</button>
                <button id="save-btn">å„²å­˜</button>
            </footer>
        </article>
    </dialog>

    <!-- æ‰¹é‡åŒ¯å…¥ Modal -->
    <dialog id="import-modal">
        <article>
            <header>
                <a href="#close" aria-label="Close" class="close" id="close-import-x"></a>
                <h3>æ‰¹é‡åŒ¯å…¥è³‡æ–™</h3>
            </header>
            <div class="import-content">
                <p>è«‹é¸æ“‡ Excel æª”æ¡ˆ (.xls, .xlsx) é€²è¡ŒåŒ¯å…¥ã€‚</p>
                <p><small>â€» æª”æ¡ˆéœ€åŒ…å«ã€Œå“è™Ÿã€èˆ‡ã€Œåœ–è™Ÿã€å…©å€‹æ¬„ä½ã€‚</small></p>
                <input type="file" id="excel-file" accept=".xls, .xlsx">
                <div id="import-progress" style="display: none;">
                    <progress id="import-progress-bar" value="0" max="100"></progress>
                    <p id="import-status">è™•ç†ä¸­...</p>
                </div>
            </div>
            <footer>
                <button class="secondary" id="cancel-import-btn">å–æ¶ˆ</button>
                <button id="start-import-btn" disabled>é–‹å§‹åŒ¯å…¥</button>
            </footer>
        </article>
    </dialog>

    <script src="{{ url_for('static', filename='js/exceljs.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/part-drawing.js') }}"></script>
</body>

</html>